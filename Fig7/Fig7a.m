close all; clear; clc; rng('default'); rng(0); tic

load('./Data/Data_Adjacency.mat')
load('./Data/Data_output.mat','year')
load('./Data/Data_Ri.mat')
mkdir('./Figure/'); mkdir('./Data/')

Reff = [function_Reff(R2011, A2011), ...
    function_Reff(R2012, A2012), ...
    function_Reff(R2013, A2013), ...
    function_Reff(R2014, A2014), ...
    function_Reff(R2015, A2015), ...
    function_Reff(R2016, A2016), ...
    function_Reff(R2017, A2017), ...
    function_Reff(R2018, A2018), ...
    function_Reff(R2019, A2019), ...
    function_Reff(R2020, A2020)];
eta = [function_eta_A(A2011), ...
    function_eta_A(A2012), ...
    function_eta_A(A2013), ...
    function_eta_A(A2014), ...
    function_eta_A(A2015), ...
    function_eta_A(A2016), ...
    function_eta_A(A2017), ...
    function_eta_A(A2018), ...
    function_eta_A(A2019), ...
    function_eta_A(A2020)];
a = 1; b = 10;
color = {[0.55,0.33,0.1], ...
    [0.93,0.69,0.13], ...
    [0.49,0.18,0.56], ...
    [124, 187, 0]./255, ...
    [84,134,135]./255, ...
    [71,51,53]./255, ...
    [189,30,30]./255, ...
    [250,200,205]./255, ...
    [210,204,161]./255, ...
    [237,177,131]./255};

save('.\Data\Data_Reff_etaeff.mat', 'Reff', 'eta', 'color', 'a', 'b')

Fig = figure(NumberTitle='off', ...
    Name='Reff vs eta');
for i = a:b
    plot(eta(i), Reff(i), ...
        Marker='.', ...
        Color=color{i}, ...
        MarkerSize=32, ...
        LineStyle='none', ...
        DisplayName=num2str(year(i)));
    hold on
end
text(0, 6.9e7, '\times10^7', ...
    FontSize=18, ...
    FontName='Arial')
legend(Location='northeast', ...
    FontName='Arial', ...
    FontSize=16, ...
    NumColumns=2)
legend boxoff;
box on
xlim([0, 70])
ylim([0, 6.5e7])
xlabel('\eta_{eff}')
ylabel('R_{eff} (ton)')
set(gca, FontName='Arial', ...
    FontSize=18, ...
    YTick=[0, 1e7, 2e7, 3e7, 4e7, 5e7, 6e7], ...
    YTickLabel={'0', '1', '2', '3', '4', '5', '6'})

saveas(Fig, './Figure/Fig7a', 'epsc')
saveas(Fig, './Figure/Fig7a')

function eta_A = function_eta_A(A)

eta_A = sum(sum(A*A)) / sum(sum(A));

end

function Reff = function_Reff(R, A)

Reff = sum(A * R) / sum(sum(A));

end